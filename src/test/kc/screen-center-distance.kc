// Calculate the distance to the center of the screen - and show it using font-hex

import "stdlib"
import "sqr"
import "c64"
import "font-hex"

#reserve(08)

const byte* CHARSET = 0x2000;
const byte* SCREEN = 0x2800;

void main() {
    init_font_hex(CHARSET);
    *D018 = toD018(SCREEN, CHARSET);
    NUM_SQUARES = 0x30;
    init_squares();
    byte* screen = SCREEN;
    for(byte y: 0..12) {
        byte y2 = y*2;
        byte yd = (y2>=24)?(y2-24):(24-y2);
        word yds = sqr(yd);
        for(byte x: 0..19) {
            byte x2 = x*2;
            byte xd = (x2>=39)?(x2-39):(39-x2);
            word xds = sqr(xd);
            word ds = xds+yds;
            byte d = sqrt(ds);
            *screen++ = d;
        }
        // Mirror x-axis
        byte *screen_mirror = screen;
        for(byte x: 0..19) {
            *screen++ = *--screen_mirror;
        }
    }
    // Mirror y-axis
    byte *screen_mirror = screen-40;
    for(byte y: 0..11) {
        for(byte x: 0..39) {
            *screen++ = *--screen_mirror;
        }
    }
}