byte[1000] SCREEN = $0400;
byte[16*16] buffer = $1000;
byte[16*16] buffer2 = $1100;

prepare();
do {
   plot();
   flip();
} while(true)

void prepare() {
   // Prepare buffer
   byte i=0;
   do {
      buffer[i] = i;
      i=i+1;
   } while (i!=0)
}

void flip() {
   // Flip buffer
}

// Plot buffer on screen
void plot() {
   byte* line = SCREEN+5*40+12;
   byte y=0;
   byte i=0;
   do {
      byte x=0;
      do {
         line[x] = buffer[i];
         x=x+1;
         i=i+1;
      } while(x<16)
      line = line+40;
      y=y+1;
   } while(y<16)
}