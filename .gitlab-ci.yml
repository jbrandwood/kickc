image: maven:3-jdk-13

release:
  stage: build
  script:
  - "mvn -e package"
  - "mkdir target/release"
  - "ls target"
  - "tar -C target/release -xzvf target/kickc-release.tgz"
  - "mv target/release/kickc/jar/kickc-release.jar target/release/kickc/jar/kickc-${CI_COMMIT_REF_NAME}.jar"
  - "mkdir ./kickc"
  - "mv target/release/kickc/* ./kickc/"
  - "cat target/site/jacoco/index.html"
  artifacts:
    name: kickc_${CI_COMMIT_REF_NAME}
    paths:
    - ./kickc/bin
    - ./kickc/jar
    - ./kickc/include
    - ./kickc/lib
    - ./kickc/target
    - ./kickc/fragment
    - ./kickc/examples
    - ./kickc/LICENSE*
    - ./kickc/NOTICE*
    - ./kickc/*.pdf
