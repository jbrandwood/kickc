byte[1000] SCREEN = $0400;
byte[16*16] buffer = $1000;
byte[16*16] buffer2 = $1100;

prepare();
do {
   plot();
   flip();
} while(true)

// Prepare buffer
void prepare() {
   byte i=0;
   do {
      buffer[i] = i;
      i=i+1;
   } while (i!=0)
}

// Flip buffer
void flip() {
   byte srcIdx = 0;
   byte dstIdx = 15;
   byte r=0;
   do {
      byte c = 0;
      do {
         buffer2[dstIdx] = buffer[srcIdx];
         srcIdx = srcIdx+1;
         dstIdx = dstIdx+16;
         c=c+1;
      } while(c<16)
      r=r+1;
      dstIdx = dstIdx-1;
    } while(r<16)
   byte i=0;
   do {
      buffer[i] = buffer2[i];
      i=i+1;
   } while (i!=0)
}

// Plot buffer on screen
void plot() {
   byte* line = SCREEN+5*40+12;
   byte y=0;
   byte i=0;
   do {
      byte x=0;
      do {
         line[x] = buffer[i];
         x=x+1;
         i=i+1;
      } while(x<16)
      line = line+40;
      y=y+1;
   } while(y<16)
}